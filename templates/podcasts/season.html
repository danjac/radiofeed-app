{% extends "base.html" %}
{% load cache %}
{% block title %}
    {% title_tag podcast.cleaned_title season.label %}
{% endblock title %}

{% block content %}
    {% fragment "podcasts/header.html" active="episodes" %}
        {% with episodes_url=podcast.get_episodes_url %}
            {% fragment "header/nav.html" %}
                {% fragment "header/nav.html#item" %}
                    {% fragment "header/nav/dropdown.html" label=season dropdown_id="seasons-dropdown" %}
                        {% include "header/nav/dropdown.html#item" with label="All Seasons" url=episodes_url %}

                        {% cache cache_timeout podcast-seasons podcast.pk %}
                            {% for season in podcast.seasons %}
                                {% include "header/nav/dropdown.html#item" with label=season.label url=season.url %}
                            {% endfor %}
                        {% endcache %}

                    {% endfragment %}
                {% endfragment %}
                {% if podcast.num_episodes > page_size %}
                    {% fragment "header/nav.html#item" %}
                        {% include "header/nav/search.html#form" with search_url=episodes_url %}
                    {% endfragment %}
                {% endif %}
            {% endfragment %}
        {% endwith %}
    {% endfragment %}
    {% partialdef pagination inline %}
        {% cache cache_timeout podcast-season-episodes request.get_full_path %}
            {% fragment "paginate.html" %}
                {% for episode in page %}
                    {% fragment "browse.html#item" %}
                        {% include "cards.html#podcast_episode" %}
                    {% endfragment %}
                {% empty %}
                    {% fragment "browse.html#empty" %}
                        This season does not have any episodes.
                    {% endfragment %}
                {% endfor %}
            {% endfragment %}
        {% endcache %}
    {% endpartialdef pagination %}
{% endblock content %}
