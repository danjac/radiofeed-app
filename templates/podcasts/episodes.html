{% extends "base.html" %}
{% load cache %}
{% block title %}
    {% title_tag podcast.cleaned_title "Episodes" %}
{% endblock title %}

{% block content %}
    {% fragment "podcasts/header.html" active="episodes" %}
        {% with num_episodes=podcast.num_episodes %}
            {% if request.search or num_episodes > page_size %}
                {% fragment "header/nav.html" %}
                    {% if request.search %}
                        {% fragment "header/nav.html#item" %}
                            {% url "episodes:search_episodes" as search_button_url %}
                            {% include "header/nav/search.html#button" with label="Search Episodes" %}
                        {% endfragment %}
                    {% else %}
                        {% fragment "header/nav.html#item" %}
                            {% if ordering == "asc" %}
                                <a class="link" href="{{ request.path }}{% querystring order='desc' page=None %}">
                                    Newest First</a>
                            {% else %}
                                <a class="link" href="{{ request.path }}{% querystring order='asc' page=None %}">
                                    Oldest First</a>
                            {% endif %}
                        {% endfragment %}
                    {% endif %}
                    {% if request.search or num_episodes > page_size %}
                        {% fragment "header/nav.html#item" %}
                            {% include "header/nav/search.html#form" with clearable=True %}
                        {% endfragment %}
                    {% endif %}
                {% endfragment %}
            {% endif %}
        {% endwith %}
    {% endfragment %}
    {% partialdef pagination inline %}
        {% cache cache_timeout podcast-episodes request.get_full_path %}
            {% fragment "paginate.html" %}
                {% for episode in page %}
                    {% fragment "browse.html#item" %}
                        {% include "cards.html#podcast_episode" %}
                    {% endfragment %}
                {% empty %}
                    {% fragment "browse.html#empty" %}
                        {% if request.search %}
                            No episodes for &quot;<strong>{{ request.search.value }}</strong>&quot; found in this podcast.
                        {% else %}
                            This podcast does not have any episodes.
                        {% endif %}
                    {% endfragment %}
                {% endfor %}
            {% endfragment %}
        {% endcache %}
    {% endpartialdef pagination %}
{% endblock content %}
