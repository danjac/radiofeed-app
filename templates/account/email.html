{% load heroicons %}
<c-layout title="Email Addresses">
    <c-account.header active="email" />
    <div class="space-y-3">
        {% with emailaddresses=user.emailaddress_set.all %}
            {% with num_addresses=emailaddresses|length %}
                {% if num_addresses %}
                    <p>The following e-mail addresses are associated with your account:</p>
                    <c-form>
                        {% for emailaddress in emailaddresses %}
                            <div class="flex items-center space-x-3">
                                <input type="radio"
                                       name="email"
                                       id="email_radio_{{ forloop.counter }}"
                                       class="form-radio"
                                       value="{{ emailaddress.email }}"
                                       {% if emailaddress.primary or num_addresses == 1 %}checked{% endif %}>
                                <label for="email_radio_{{ forloop.counter }}"
                                       class="flex items-center space-x-3">
                                    <span {% if emailaddress.primary or num_addresses == 1 %}class="font-bold"{% endif %}>{{ emailaddress.email }}</span>
                                    {% if emailaddress.verified %}
                                        {% heroicon_mini "check" class="text-green-600" title="Verified" %}
                                    {% endif %}
                                </label>
                            </div>
                        {% endfor %}
                        <c-form.buttons>
                            {% if num_addresses == 1 %}
                                <c-button.default
                                    icon="hand-thumb-up"
                                    disabled
                                    title="You cannot set the only e-mail address associated with your account as primary."
                                >
                                    Primary
                                </c-button.default>
                                <c-button.default
                                    icon="trash"
                                    disabled
                                    title="You cannot remove the only e-mail address associated with your account."
                                >
                                    Remove
                                </c-button.default>
                            {% else %}
                                <c-button.primary
                                    icon="hand-thumb-up"
                                    name="action_primary"
                                    value="1"
                                >
                                    Primary
                                </c-button.primary>
                                <c-button.danger
                                    icon="trash"
                                    name="action_remove"
                                    value="1"
                                >
                                    Remove
                                </c-button.danger>
                            {% endif %}
                            <c-button.default
                                icon="envelope"
                                name="action_send"
                                value="1">
                                Re-Verify
                            </c-button.default>
                        </c-form.buttons>
                    </c-form>
                {% else %}
                    <p>
                        <strong>Warning:</strong>
                        You currently do not have any e-mail address set up. You should really add an e-mail address so you can receive notifications, reset your password, etc.
                    </p>
                {% endif %}
            {% endwith %}
        {% endwith %}
        {% if can_add_email %}
            <hr class="border"/>
            <h2 class="text-base font-semibold lg:text-lg">Add New E-mail Address</h2>
            <c-form>
                {{ form }}
                <c-form.buttons>
                    <c-button.primary
                        icon="plus"
                        name="action_add"
                        value="1">
                        Add E-Mail
                    </c-button>
                </c-form.buttons>
            </c-form>
        {% endif %}
    </div>
</c-layout>
